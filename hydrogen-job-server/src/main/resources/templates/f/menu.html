<th:block th:fragment="menu(items)">
    <ul th:if="${items != null and items.size() > 0}">
        <li th:each="item : ${items}" th:classappend=
                "${(item.active ? 'active' : '') + (item.subItems != null and item.subItems.size() > 0 ?'has-sub' : '')}">
            <div class="menu-item-text" th:text="${item.name}"></div>
            <th:block th:replace="~{::menu(${item.subItems})}"></th:block>
        </li>
    </ul>
</th:block>